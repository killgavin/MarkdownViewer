# 軟體設計文件 (Software Design Document)

## Markdown 檢視器專案

**版本：** 1.0  
**日期：** 2026-01-22  
**作者：** Markdown Viewer Development Team

---

## 1. 專案概述

### 1.1 專案目標

開發一個基於 VB.NET Windows Forms 的 Markdown 檔案檢視軟體，提供使用者友善的正體中文介面，能夠開啟並預覽 Markdown 格式文件。

### 1.2 專案範疇

- 支援開啟標準 Markdown 檔案（.md、.markdown）
- 提供即時 HTML 渲染預覽功能
- 提供正體中文使用者介面
- 支援完整的 Markdown 語法（標題、清單、表格、程式碼區塊等）

### 1.3 目標使用者

需要檢視 Markdown 文件的一般使用者，特別是需要正體中文介面的使用者。

---

## 2. 系統架構

### 2.1 技術架構

```
┌─────────────────────────────────────┐
│     使用者介面層 (UI Layer)          │
│  - MainForm (主視窗)                 │
│  - ToolStrip (工具列)                │
│  - StatusStrip (狀態列)              │
│  - WebBrowser (預覽控制項)           │
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│    業務邏輯層 (Business Logic)       │
│  - 檔案載入處理                      │
│  - Markdown 轉換處理                 │
│  - 錯誤處理                          │
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│      資料存取層 (Data Access)        │
│  - System.IO (檔案讀取)              │
│  - Markdig (Markdown 引擎)           │
└─────────────────────────────────────┘
```

### 2.2 元件說明

#### 2.2.1 MainForm（主視窗）

主要的使用者介面視窗，包含以下元件：

- **ToolStrip（工具列）**
  - 開啟檔案按鈕
  - 關於按鈕
  
- **WebBrowser（網頁瀏覽控制項）**
  - 用於顯示轉換後的 HTML 內容
  
- **StatusStrip（狀態列）**
  - 顯示當前檔案載入狀態

#### 2.2.2 Markdig 引擎

使用 Markdig NuGet 套件進行 Markdown 到 HTML 的轉換：
- 支援標準 Markdown 語法
- 支援擴展語法（表格、任務清單等）
- 高效能的解析與轉換

---

## 3. 介面設計

### 3.1 主視窗介面

```
┌─────────────────────────────────────────┐
│ Markdown 檢視器                    - □ × │
├─────────────────────────────────────────┤
│ [開啟檔案] | [關於]                       │
├─────────────────────────────────────────┤
│                                         │
│                                         │
│         Markdown 預覽區域                │
│        (WebBrowser 控制項)               │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│ 準備就緒                                 │
└─────────────────────────────────────────┘
```

### 3.2 介面元素規格

| 元素 | 類型 | 說明 | 尺寸 |
|------|------|------|------|
| 主視窗 | Form | 應用程式主視窗 | 1000 x 597 px |
| 工具列 | ToolStrip | 功能按鈕列 | 自動調整 |
| 預覽區 | WebBrowser | Markdown 內容顯示 | 填滿剩餘空間 |
| 狀態列 | StatusStrip | 狀態訊息顯示 | 22 px 高度 |

---

## 4. 資料流程

### 4.1 開啟檔案流程

```
[使用者點選「開啟檔案」]
         ↓
[顯示檔案選擇對話框]
         ↓
[使用者選擇 Markdown 檔案]
         ↓
[讀取檔案內容（UTF-8）]
         ↓
[使用 Markdig 轉換為 HTML]
         ↓
[套用 CSS 樣式]
         ↓
[在 WebBrowser 中顯示]
         ↓
[更新狀態列訊息]
```

### 4.2 錯誤處理流程

```
[發生錯誤]
    ↓
[捕捉例外（Try-Catch）]
    ↓
[顯示錯誤訊息對話框]
    ↓
[記錄錯誤（選用）]
```

---

## 5. 功能規格

### 5.1 功能列表

| 功能編號 | 功能名稱 | 優先級 | 狀態 |
|---------|---------|--------|------|
| F-001 | 開啟 Markdown 檔案 | 高 | ✅ 完成 |
| F-002 | 顯示 HTML 預覽 | 高 | ✅ 完成 |
| F-003 | 支援標準 Markdown 語法 | 高 | ✅ 完成 |
| F-004 | 支援擴展語法（表格等） | 中 | ✅ 完成 |
| F-005 | 正體中文介面 | 高 | ✅ 完成 |
| F-006 | 狀態列顯示 | 中 | ✅ 完成 |
| F-007 | 關於對話框 | 低 | ✅ 完成 |

### 5.2 功能詳細說明

#### F-001: 開啟 Markdown 檔案

**描述：** 使用者可以透過檔案對話框選擇並開啟 Markdown 檔案。

**輸入：** Markdown 檔案路徑

**處理：**
1. 顯示 OpenFileDialog
2. 篩選器設定為 .md 和 .markdown 檔案
3. 讀取選擇的檔案內容

**輸出：** 檔案內容字串

**錯誤處理：**
- 檔案不存在：顯示錯誤訊息
- 檔案無法讀取：顯示錯誤訊息
- 編碼問題：使用 UTF-8 編碼讀取

#### F-002: 顯示 HTML 預覽

**描述：** 將 Markdown 內容轉換為 HTML 並在視窗中顯示。

**輸入：** Markdown 文字內容

**處理：**
1. 使用 Markdig 引擎轉換
2. 包裝成完整的 HTML 文件
3. 套用 CSS 樣式
4. 載入至 WebBrowser 控制項

**輸出：** 格式化的 HTML 顯示

---

## 6. 非功能性需求

### 6.1 效能需求

- 檔案載入時間：< 2 秒（100KB 以內的檔案）
- 介面回應時間：< 0.5 秒

### 6.2 可用性需求

- 所有介面文字使用正體中文
- 按鈕與控制項應有明確的文字標示
- 錯誤訊息應清楚易懂

### 6.3 相容性需求

- 支援 Windows 10 及更新版本
- 需要 .NET 10.0 Runtime

### 6.4 可維護性需求

- 程式碼應有適當的註解
- 遵循 VB.NET 命名慣例
- 模組化設計，便於未來擴展

---

## 7. 相依套件

| 套件名稱 | 版本 | 用途 |
|---------|------|------|
| Markdig | 0.37.0 | Markdown 轉 HTML 引擎 |

---

## 8. 開發階段

### 階段一：專案初始化（已完成）
- 建立 VB.NET Windows Forms 專案
- 設定專案結構
- 加入 Markdig 相依套件

### 階段二：核心功能開發（已完成）
- 實作主視窗介面
- 實作檔案開啟功能
- 實作 Markdown 轉 HTML 功能
- 實作預覽顯示功能

### 階段三：介面優化（已完成）
- 加入工具列
- 加入狀態列
- 正體中文化所有文字
- 優化 CSS 樣式

### 階段四：測試與文件（已完成）
- 建立範例 Markdown 檔案
- 撰寫 README 文件
- 撰寫軟體設計文件

---

## 9. 測試計畫

### 9.1 功能測試

| 測試項目 | 測試步驟 | 預期結果 |
|---------|---------|---------|
| 開啟檔案 | 1. 點選「開啟檔案」<br>2. 選擇 .md 檔案 | 檔案內容正確顯示 |
| Markdown 渲染 | 開啟包含各種語法的 .md 檔案 | 所有語法正確渲染 |
| 錯誤處理 | 開啟不存在的檔案 | 顯示錯誤訊息 |
| 關於對話框 | 點選「關於」按鈕 | 顯示版本資訊 |

### 9.2 介面測試

- 驗證所有文字為正體中文
- 驗證按鈕功能正常
- 驗證視窗大小調整時排版正常

---

## 10. 未來擴展計畫

### 10.1 短期計畫

- 加入列印功能
- 加入檔案另存為 HTML 功能
- 加入最近開啟檔案清單

### 10.2 中期計畫

- 加入自訂 CSS 主題功能
- 加入搜尋功能
- 加入書籤功能

### 10.3 長期計畫

- 加入即時編輯功能
- 支援多分頁檢視
- 加入外掛系統

---

## 11. 版本歷程

| 版本 | 日期 | 說明 |
|------|------|------|
| 1.0 | 2026-01-22 | 初始版本發布 |

---

## 12. 參考資料

- [Markdown 語法說明](https://markdown.tw/)
- [Markdig 官方文件](https://github.com/xoofx/markdig)
- [VB.NET Windows Forms 文件](https://docs.microsoft.com/zh-tw/dotnet/desktop/winforms/)

---

**文件結束**
